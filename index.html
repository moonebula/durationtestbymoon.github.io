<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <title>Loading Demo – 1 Hz / 15 s</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root {
      --ball-size-min: 64px;
      --ball-size-vw: 7vw;
      --main: #82e0aa;
    }
    body {
      margin: 0; height: 100vh; display: flex; flex-direction: column;
      justify-content: center; align-items: center; background: #fff;
      font-family: sans-serif; overflow: hidden; user-select: none; cursor: default;
    }

    #ball {
      width: clamp(var(--ball-size-min), var(--ball-size-vw), 120px);
      aspect-ratio: 1;
      border-radius: 50%;
      background: var(--main);
      box-shadow: 0 0 20px rgba(79, 141, 255, .35);
      will-change: transform;
      animation: bounce 1s infinite;
    }

    @keyframes bounce {
      0%   { transform: translateY(0); animation-timing-function: cubic-bezier(.25, .46, .45, .94); }
      50%  { transform: translateY(-20vh); animation-timing-function: cubic-bezier(.55, .05, .79, .68); }
      100% { transform: translateY(0); }
    }

    #msg {
      margin-top: 4vh;
      font-size: clamp(1.2rem, 3vw, 2rem);
      color: #333;
      opacity: 0;
      transition: opacity .4s;
    }
    #msg.show { opacity: 1; }
  </style>
</head>

<body>

  <div id="ball"></div>
  <div id="msg">Loading…</div>

  <!-- ✅ 隐藏表单（用于提交 T-threshold） -->
  <form id="gform"
        action="https://docs.google.com/forms/d/e/1FAIpQLSdVxUZN9cIgZQTmaq2PRr73sGO51Gb4fJ4r6jdKF0-ic7EyxQ/formResponse"
        method="POST"
        target="hidden_iframe"
        style="display: none;">
    <input name="entry.1026342006" id="rtInput" type="text">
  </form>
  <iframe name="hidden_iframe" style="display: none;"></iframe>

<script>
  const TOTAL_MS   = 15000;
  const PROMPT_MS  = TOTAL_MS * 0.20;
  const ENABLE_CLK = 5000;
  const t0         = performance.now();

  setTimeout(() => {
    document.getElementById('msg').classList.add('show');
  }, PROMPT_MS);

  function goThanks() {
    const rt = Math.round(performance.now() - t0);
    document.getElementById('rtInput').value = rt;

    // 提交表单（兼容移动端）并延迟跳转
    const form = document.getElementById('gform');
    form.submit();

    setTimeout(() => {
      window.location.href = 'thanks.html';
    }, 1000); // 增加延迟，确保移动端 iframe 提交稳定
  }

  function trySkip() {
    if (performance.now() - t0 >= ENABLE_CLK) goThanks();
  }

  document.body.addEventListener('click', trySkip, { passive: true });
  document.body.addEventListener('touchstart', trySkip, { passive: true });

  setTimeout(goThanks, TOTAL_MS);
</script>

</body>
</html>
